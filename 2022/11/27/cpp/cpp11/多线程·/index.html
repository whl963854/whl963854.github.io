<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>多线程 | Hexo</title>
  <meta name="keywords" content=" c++11 ">
  <meta name="description" content="多线程 | Hexo">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="页面未找到！">
<meta property="og:type" content="website">
<meta property="og:title" content="404">
<meta property="og:url" content="http://example.com/404/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="页面未找到！">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2016-09-27T03:31:01.000Z">
<meta property="article:modified_time" content="2022-09-13T11:24:43.803Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 6.0.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>John Doe</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-rss"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/whl963854"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <a title="email"
               href="mailto:3366576307@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=3366576307&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
</div>



    <a class="more-menus">更多菜单</a>


<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(139)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="软工">
                        
                        软工
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="设计模式">
                        
                        设计模式
                        <small>(24)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="算法">
                        
                        算法
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="题解">
                        
                        题解
                        <small>(26)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="cpp">
                        
                        cpp
                        <small>(56)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Database">
                        
                        Database
                        <small>(21)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Git">
                        
                        Git
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Linux">
                        
                        Linux
                        <small>(4)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
                <a class="dynamic-menu "
                   target="_blank"
                        
                   href="https://github.com/whl963854">github</a>
        
    </div>
    <div>
        
            <a class="about  hasFriend  "
               target="_blank"
                    
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="139">
<input type="hidden" id="yelog_site_word_count" value="155.5k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>编码规范</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>创建型模式</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>动态规划</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>华为可信课程</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>剑指offer</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>结构型模式</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>蓝桥</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>码题集</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>软工</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>现代cpp</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>行为型模式</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>字节</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>c++11</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>cpp</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>csp</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>leetcode</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>math</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>MySQL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>NoSQL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Redis</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>STL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>wps</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="All Database "
           href="/2023/04/15/DataBase/MySQL/B+Tree/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="B+树和B树的区别">B+树和B树的区别</span>
            <span class="post-date" title="2023-04-15 15:16:30">2023/04/15</span>
        </a>
        
        
        <a  class="All Linux "
           href="/2023/04/09/Linux/Linux%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90/"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Linux用户和权限">Linux用户和权限</span>
            <span class="post-date" title="2023-04-09 16:09:46">2023/04/09</span>
        </a>
        
        
        <a  class="All Linux "
           href="/2023/04/09/Linux/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Linux基本命令">Linux基本命令</span>
            <span class="post-date" title="2023-04-09 15:43:31">2023/04/09</span>
        </a>
        
        
        <a  class="All Linux "
           href="/2023/04/09/Linux/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Linux文件管理">Linux文件管理</span>
            <span class="post-date" title="2023-04-09 15:04:48">2023/04/09</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/06/cpp/%E7%8E%B0%E4%BB%A3cpp/%E7%BA%BF%E7%A8%8B%E6%B1%A0/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="线程池">线程池</span>
            <span class="post-date" title="2023-04-06 21:15:15">2023/04/06</span>
        </a>
        
        
        <a  class="All "
           href="/2023/04/05/TODO/%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title=""></span>
            <span class="post-date" title="2023-04-05 16:47:27">2023/04/05</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/04/OS/%E6%AD%BB%E9%94%81/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="死锁">死锁</span>
            <span class="post-date" title="2023-04-04 22:56:12">2023/04/04</span>
        </a>
        
        
        <a  class="All Database "
           href="/2023/04/04/DataBase/MySQL/%E6%97%A5%E5%BF%97%E7%B1%BB%E5%9E%8B/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="日志类型">日志类型</span>
            <span class="post-date" title="2023-04-04 20:30:49">2023/04/04</span>
        </a>
        
        
        <a  class="All Database "
           href="/2023/04/04/DataBase/MySQL/%E4%BA%8B%E5%8A%A1%E4%B8%89%E7%A7%8D%E6%8F%90%E4%BA%A4%E9%97%AE%E9%A2%98/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="事务三种提交问题">事务三种提交问题</span>
            <span class="post-date" title="2023-04-04 19:48:39">2023/04/04</span>
        </a>
        
        
        <a  class="All Database "
           href="/2023/04/04/DataBase/MySQL/%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="事务隔离级别">事务隔离级别</span>
            <span class="post-date" title="2023-04-04 19:39:30">2023/04/04</span>
        </a>
        
        
        <a  class="All 算法 "
           href="/2023/04/04/TODO/%E5%B9%B6%E6%9F%A5%E9%9B%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="并查集">并查集</span>
            <span class="post-date" title="2023-04-04 09:23:30">2023/04/04</span>
        </a>
        
        
        <a  class="All 算法 "
           href="/2023/04/04/TODO/%E5%B8%A6%E6%9D%83%E5%B9%B6%E6%9F%A5%E9%9B%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="带权并查集">带权并查集</span>
            <span class="post-date" title="2023-04-04 09:19:22">2023/04/04</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/02/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/%E8%99%9A%E5%87%BD%E6%95%B0%E8%A1%A8/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="虚函数表">虚函数表</span>
            <span class="post-date" title="2023-04-02 22:49:10">2023/04/02</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/02/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/cpp%E4%BB%A3%E7%A0%81%E5%88%B0exe/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="cpp代码到exe">cpp代码到exe</span>
            <span class="post-date" title="2023-04-02 20:20:53">2023/04/02</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/02/cpp/cpp11/%E5%9B%9B%E7%A7%8D%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="类型转换">类型转换</span>
            <span class="post-date" title="2023-04-02 19:56:58">2023/04/02</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/02/cpp/cpp11/%E7%A7%BB%E5%8A%A8%E8%AF%AD%E4%B9%89/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="移动语义">移动语义</span>
            <span class="post-date" title="2023-04-02 19:27:59">2023/04/02</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/02/cpp/cpp11/move/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="move">move</span>
            <span class="post-date" title="2023-04-02 16:52:48">2023/04/02</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/02/cpp/cpp11/%E5%B7%A6%E5%80%BC%E5%8F%B3%E5%80%BC/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="左值右值">左值右值</span>
            <span class="post-date" title="2023-04-02 15:30:23">2023/04/02</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/04/02/cpp/cpp11/%E5%AE%8C%E7%BE%8E%E8%BD%AC%E5%8F%91/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="完美转发">完美转发</span>
            <span class="post-date" title="2023-04-02 15:24:52">2023/04/02</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/15/cpp/%E7%8E%B0%E4%BB%A3cpp/%E5%B9%B6%E5%8F%91/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="并发">并发</span>
            <span class="post-date" title="2023-03-15 23:04:38">2023/03/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/11/cpp/%E7%8E%B0%E4%BB%A3cpp/%E5%86%85%E5%AD%98/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="内存">内存</span>
            <span class="post-date" title="2023-03-11 23:53:41">2023/03/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/11/cpp/%E7%8E%B0%E4%BB%A3cpp/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="智能指针">智能指针</span>
            <span class="post-date" title="2023-03-11 23:49:23">2023/03/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/11/cpp/%E7%8E%B0%E4%BB%A3cpp/%E4%B8%8E%E6%97%B6%E9%97%B4%E6%9C%89%E5%85%B3%E7%9A%84%E7%A8%8B%E5%BA%8F/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="与时间有关的程序">与时间有关的程序</span>
            <span class="post-date" title="2023-03-11 22:36:47">2023/03/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/11/cpp/%E7%8E%B0%E4%BB%A3cpp/%E5%B7%A6%E5%80%BC%E5%BC%95%E7%94%A8%E5%92%8C%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="左值引用和右值引用">左值引用和右值引用</span>
            <span class="post-date" title="2023-03-11 10:22:51">2023/03/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/11/cpp/%E7%8E%B0%E4%BB%A3cpp/lambda%E7%9A%84%E4%BD%BF%E7%94%A8/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="lambda的使用">lambda的使用</span>
            <span class="post-date" title="2023-03-11 09:58:25">2023/03/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/10/cpp/%E7%8E%B0%E4%BB%A3cpp/%E7%BC%96%E8%AF%91%E6%97%B6%E5%B8%B8%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="编译时常量的使用">编译时常量的使用</span>
            <span class="post-date" title="2023-03-10 23:30:43">2023/03/10</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/10/cpp/%E7%8E%B0%E4%BB%A3cpp/%E7%B1%BB%E5%9E%8B%E6%8E%A8%E6%96%AD/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="类型推断">类型推断</span>
            <span class="post-date" title="2023-03-10 22:27:43">2023/03/10</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/03/09/cpp/%E7%8E%B0%E4%BB%A3cpp/%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%98%E9%87%8F/"
           data-tag="现代cpp"
           data-author="" >
            <span class="post-title" title="初始化变量">初始化变量</span>
            <span class="post-date" title="2023-03-09 13:45:00">2023/03/09</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/02/19/cpp/cpp11/%E5%A7%94%E6%B4%BE%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="委派构造函数">委派构造函数</span>
            <span class="post-date" title="2023-02-19 23:09:08">2023/02/19</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2023/02/15/%E9%A2%98%E8%A7%A3/%E7%BB%9F%E8%AE%A1%E5%AD%90%E7%9F%A9%E9%98%B5/"
           data-tag="蓝桥"
           data-author="" >
            <span class="post-title" title="统计子矩阵">统计子矩阵</span>
            <span class="post-date" title="2023-02-15 16:07:28">2023/02/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2023/02/15/cpp/zSTL/hashtable/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="Hashtable">Hashtable</span>
            <span class="post-date" title="2023-02-15 15:08:09">2023/02/15</span>
        </a>
        
        
        <a  class="All "
           href="/2023/01/11/git/git%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87/"
           data-tag=""
           data-author="" >
            <span class="post-title" title=""></span>
            <span class="post-date" title="2023-01-11 15:05:36">2023/01/11</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/12/25/%E9%A2%98%E8%A7%A3/%E6%A3%98%E6%89%8B%E6%80%80%E5%BF%B5%E6%91%A7%E6%AF%81/"
           data-tag="码题集"
           data-author="" >
            <span class="post-title" title="棘手怀念摧毁">棘手怀念摧毁</span>
            <span class="post-date" title="2022-12-25 19:40:47">2022/12/25</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/12/16/DataBase/Redis/SpringDataRedis/"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="SpringDataRedis">SpringDataRedis</span>
            <span class="post-date" title="2022-12-16 19:23:43">2022/12/16</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/12/16/DataBase/Redis/Jedis/"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="Jedis">Jedis</span>
            <span class="post-date" title="2022-12-16 19:14:50">2022/12/16</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/12/16/DataBase/Redis/%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/"
           data-tag="Redis"
           data-author="" >
            <span class="post-title" title="Redis常见命令">Redis常见命令</span>
            <span class="post-date" title="2022-12-16 17:09:34">2022/12/16</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/12/16/DataBase/Redis/NoSQL/"
           data-tag="NoSQL"
           data-author="" >
            <span class="post-title" title="NoSQL">NoSQL</span>
            <span class="post-date" title="2022-12-16 17:03:38">2022/12/16</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/11/27/cpp/cpp11/%E5%A4%9A%E7%BA%BF%E7%A8%8B%C2%B7/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="多线程">多线程</span>
            <span class="post-date" title="2022-11-27 17:02:58">2022/11/27</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/26/DesignMode/Behavioral%20Pattern/%E8%A7%A3%E6%9E%90%E5%99%A8%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="解析器模式">解析器模式</span>
            <span class="post-date" title="2022-11-26 16:21:36">2022/11/26</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/26/DesignMode/Behavioral%20Pattern/%E8%AE%BF%E9%97%AE%E5%99%A8/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="访问器模式">访问器模式</span>
            <span class="post-date" title="2022-11-26 16:06:00">2022/11/26</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/26/DesignMode/Behavioral%20Pattern/%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="职责链模式">职责链模式</span>
            <span class="post-date" title="2022-11-26 15:56:40">2022/11/26</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/26/DesignMode/Behavioral%20Pattern/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="迭代器模式">迭代器模式</span>
            <span class="post-date" title="2022-11-26 15:42:22">2022/11/26</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/26/DesignMode/Behavioral%20Pattern/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="中介者模式">中介者模式</span>
            <span class="post-date" title="2022-11-26 15:29:22">2022/11/26</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/26/DesignMode/Structural%20Pattern/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"
           data-tag="结构型模式"
           data-author="" >
            <span class="post-title" title="组合模式">组合模式</span>
            <span class="post-date" title="2022-11-26 15:22:50">2022/11/26</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/26/DesignMode/Structural%20Pattern/%E9%97%A8%E9%9D%A2%E6%A8%A1%E5%BC%8F/"
           data-tag="结构型模式"
           data-author="" >
            <span class="post-title" title="门面模式">门面模式</span>
            <span class="post-date" title="2022-11-26 15:06:14">2022/11/26</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/26/DesignMode/Structural%20Pattern/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"
           data-tag="结构型模式"
           data-author="" >
            <span class="post-title" title="享元模式">享元模式</span>
            <span class="post-date" title="2022-11-26 14:51:16">2022/11/26</span>
        </a>
        
        
        <a  class="All 软工 "
           href="/2022/11/23/soft/"
           data-tag="软工"
           data-author="" >
            <span class="post-title" title="某些小项目">某些小项目</span>
            <span class="post-date" title="2022-11-23 16:13:10">2022/11/23</span>
        </a>
        
        
        <a  class="All Linux "
           href="/2022/11/23/Linux/Linux%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Linux简介">Linux简介</span>
            <span class="post-date" title="2022-11-23 15:59:13">2022/11/23</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/21/DesignMode/Behavioral%20Pattern/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="备忘录模式">备忘录模式</span>
            <span class="post-date" title="2022-11-21 20:58:19">2022/11/21</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/11/21/DesignMode/Behavioral%20Pattern/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="状态模式">状态模式</span>
            <span class="post-date" title="2022-11-21 20:32:29">2022/11/21</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/11/20/%E9%A2%98%E8%A7%A3/%E9%A6%99%E6%A7%9F%E5%A1%94/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="香槟塔">香槟塔</span>
            <span class="post-date" title="2022-11-20 21:12:37">2022/11/20</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/11/19/%E9%A2%98%E8%A7%A3/%E5%8C%B9%E9%85%8D%E5%AD%90%E5%BA%8F%E5%88%97%E7%9A%84%E5%8D%95%E8%AF%8D%E6%95%B0/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="匹配子序列的单词数">匹配子序列的单词数</span>
            <span class="post-date" title="2022-11-19 16:42:23">2022/11/19</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/10/20/%E9%A2%98%E8%A7%A3/csp/2022_09_3/"
           data-tag="csp"
           data-author="" >
            <span class="post-title" title="防疫大数据">防疫大数据</span>
            <span class="post-date" title="2022-10-20 19:33:24">2022/10/20</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/18/cpp/hj/RvalueReferences/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="RvalueReference">RvalueReference</span>
            <span class="post-date" title="2022-10-18 14:59:21">2022/10/18</span>
        </a>
        
        
        <a  class="All "
           href="/2022/10/16/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/csp/"
           data-tag=""
           data-author="" >
            <span class="post-title" title=""></span>
            <span class="post-date" title="2022-10-16 15:25:47">2022/10/16</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/10/16/%E9%A2%98%E8%A7%A3/%E6%9C%80%E9%95%BF%E5%9B%9E%E6%96%87%E5%AD%90%E4%B8%B2/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="最长回文子串">最长回文子串</span>
            <span class="post-date" title="2022-10-16 13:32:46">2022/10/16</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/10/15/DesignMode/Behavioral%20Pattern/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="命令模式">命令模式</span>
            <span class="post-date" title="2022-10-15 15:32:21">2022/10/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/15/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/cpp%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/"
           data-tag="wps"
           data-author="" >
            <span class="post-title" title="c++编码规范">c++编码规范</span>
            <span class="post-date" title="2022-10-15 15:26:48">2022/10/15</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/10/13/%E9%A2%98%E8%A7%A3/%E6%9C%80%E9%95%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%93%BE/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="最长字符串链">最长字符串链</span>
            <span class="post-date" title="2022-10-13 13:59:07">2022/10/13</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/11/cpp/hj/otherthings/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="Otherthings">Otherthings</span>
            <span class="post-date" title="2022-10-11 19:24:37">2022/10/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/11/cpp/hj/TemplateTemplateParameter/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="Template Template Parameter">Template Template Parameter</span>
            <span class="post-date" title="2022-10-11 19:04:35">2022/10/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/11/cpp/hj/Alias%20Template/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="Alias Template">Alias Template</span>
            <span class="post-date" title="2022-10-11 18:45:06">2022/10/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/10/cpp/cpp11/Initialization/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="Initialization">Initialization</span>
            <span class="post-date" title="2022-10-10 16:54:01">2022/10/10</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/10/cpp/hj/%E5%8F%98%E5%8F%82%E6%A8%A1%E6%9D%BF/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="变参模板">变参模板</span>
            <span class="post-date" title="2022-10-10 16:31:16">2022/10/10</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/07/cpp/zSTL/STL/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="STL">STL</span>
            <span class="post-date" title="2022-10-07 18:29:52">2022/10/07</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/10/02/cpp/cpp11/unique_ptr/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="unique_ptr">unique_ptr</span>
            <span class="post-date" title="2022-10-02 19:53:58">2022/10/02</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/10/02/DesignMode/Creational%20Pattern/%E6%9E%84%E5%BB%BA%E5%99%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="构建器模式">构建器模式</span>
            <span class="post-date" title="2022-10-02 19:01:32">2022/10/02</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/10/02/DataBase/MySQL/InnoDB/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="InnoDB引擎">InnoDB引擎</span>
            <span class="post-date" title="2022-10-02 15:15:37">2022/10/02</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/29/DataBase/MySQL/%E9%94%81/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="锁">锁</span>
            <span class="post-date" title="2022-09-29 23:16:11">2022/09/29</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/29/DesignMode/Structural%20Pattern/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"
           data-tag="结构型模式"
           data-author="" >
            <span class="post-title" title="装饰者模式">装饰者模式</span>
            <span class="post-date" title="2022-09-29 16:22:07">2022/09/29</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/29/DesignMode/Structural%20Pattern/%E6%A1%A5%E6%A8%A1%E5%BC%8F/"
           data-tag="结构型模式"
           data-author="" >
            <span class="post-title" title="桥模式">桥模式</span>
            <span class="post-date" title="2022-09-29 15:51:18">2022/09/29</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/28/%E9%A2%98%E8%A7%A3/%E8%B6%85%E8%BF%87%E4%B8%80%E5%8D%8A%E7%9A%84%E6%95%B0%E5%AD%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="超过一半的数字">超过一半的数字</span>
            <span class="post-date" title="2022-09-28 20:03:36">2022/09/28</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/27/%E9%A2%98%E8%A7%A3/%E6%95%B0%E7%BB%84%E4%B8%AD%E6%95%B0%E5%AD%97%E5%87%BA%E7%8E%B0%E7%9A%84%E6%AC%A1%E6%95%B0/"
           data-tag="剑指offer"
           data-author="" >
            <span class="post-title" title="数组中数字出现的个数">数组中数字出现的个数</span>
            <span class="post-date" title="2022-09-27 21:20:30">2022/09/27</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/27/DataBase/MySQL/%E8%A7%A6%E5%8F%91%E5%99%A8/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="触发器">触发器</span>
            <span class="post-date" title="2022-09-27 16:04:13">2022/09/27</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/23/DataBase/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="存储过程">存储过程</span>
            <span class="post-date" title="2022-09-23 12:44:39">2022/09/23</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/23/DataBase/MySQL/%E8%A7%86%E5%9B%BE/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="视图">视图</span>
            <span class="post-date" title="2022-09-23 11:04:20">2022/09/23</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/22/DesignMode/Behavioral%20Pattern/%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="模板模式">模板模式</span>
            <span class="post-date" title="2022-09-22 19:52:54">2022/09/22</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/22/DesignMode/Structural%20Pattern/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"
           data-tag="结构型模式"
           data-author="" >
            <span class="post-title" title="适配器模式">适配器模式</span>
            <span class="post-date" title="2022-09-22 19:31:55">2022/09/22</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/22/DesignMode/Creational%20Pattern/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"
           data-tag="创建型模式"
           data-author="" >
            <span class="post-title" title="建造者模式">建造者模式</span>
            <span class="post-date" title="2022-09-22 19:20:40">2022/09/22</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/22/DesignMode/Structural%20Pattern/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"
           data-tag="结构型模式"
           data-author="" >
            <span class="post-title" title="代理模式">代理模式</span>
            <span class="post-date" title="2022-09-22 18:57:19">2022/09/22</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/22/DesignMode/Creational%20Pattern/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"
           data-tag="创建型模式"
           data-author="" >
            <span class="post-title" title="原型模式">原型模式</span>
            <span class="post-date" title="2022-09-22 18:35:08">2022/09/22</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/22/DesignMode/Behavioral%20Pattern/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="观察者模式">观察者模式</span>
            <span class="post-date" title="2022-09-22 16:22:50">2022/09/22</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/21/DataBase/MySQL/%E4%BC%98%E5%8C%96/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="优化">优化</span>
            <span class="post-date" title="2022-09-21 19:27:54">2022/09/21</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/20/DataBase/MySQL/%E7%B4%A2%E5%BC%95/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="索引">索引</span>
            <span class="post-date" title="2022-09-20 19:41:27">2022/09/20</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/20/DataBase/MySQL/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="存储引擎">存储引擎</span>
            <span class="post-date" title="2022-09-20 19:14:39">2022/09/20</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/20/DataBase/MySQL/%E4%BA%8B%E5%8A%A1/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="事务">事务</span>
            <span class="post-date" title="2022-09-20 18:37:59">2022/09/20</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/20/DataBase/MySQL/%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="多表查询">多表查询</span>
            <span class="post-date" title="2022-09-20 15:09:37">2022/09/20</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/20/DataBase/MySQL/%E7%BA%A6%E6%9D%9F/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="约束">约束</span>
            <span class="post-date" title="2022-09-20 14:27:02">2022/09/20</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/20/DataBase/MySQL/%E5%87%BD%E6%95%B0/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="函数">函数</span>
            <span class="post-date" title="2022-09-20 13:07:32">2022/09/20</span>
        </a>
        
        
        <a  class="All Database "
           href="/2022/09/20/DataBase/MySQL/%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"
           data-tag="MySQL"
           data-author="" >
            <span class="post-title" title="SQL">SQL</span>
            <span class="post-date" title="2022-09-20 10:02:57">2022/09/20</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/16/cpp/zSTL/CommonSetAlgorithms/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="常用集合算法">常用集合算法</span>
            <span class="post-date" title="2022-09-16 20:39:48">2022/09/16</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/16/cpp/zSTL/CommonFunctionGenerationAlgorithms/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="常用算术生成算法">常用算术生成算法</span>
            <span class="post-date" title="2022-09-16 20:38:46">2022/09/16</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/16/cpp/zSTL/CopyAndReplace/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="常用拷贝和替换算法">常用拷贝和替换算法</span>
            <span class="post-date" title="2022-09-16 20:25:30">2022/09/16</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/16/cpp/zSTL/CommonSortAlgorithm/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="常用排序算法">常用排序算法</span>
            <span class="post-date" title="2022-09-16 19:53:06">2022/09/16</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/16/cpp/zSTL/CommomAlgorithm/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="STL常用算法">STL常用算法</span>
            <span class="post-date" title="2022-09-16 13:06:00">2022/09/16</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/16/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/%E5%86%85%E5%BB%BA%E5%87%BD%E6%95%B0%E5%AF%B9%E8%B1%A1/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="内建函数对象">内建函数对象</span>
            <span class="post-date" title="2022-09-16 12:35:16">2022/09/16</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/zSTL/map/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="map/multimap">map/multimap</span>
            <span class="post-date" title="2022-09-15 21:12:00">2022/09/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/zSTL/set/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="set/multiset">set/multiset</span>
            <span class="post-date" title="2022-09-15 21:07:26">2022/09/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/zSTL/list/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="List">List</span>
            <span class="post-date" title="2022-09-15 20:34:58">2022/09/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/zSTL/queue/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="queue">queue</span>
            <span class="post-date" title="2022-09-15 20:33:56">2022/09/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/zSTL/stack/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="stack">stack</span>
            <span class="post-date" title="2022-09-15 20:25:14">2022/09/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/zSTL/deque/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="deque">deque</span>
            <span class="post-date" title="2022-09-15 20:06:02">2022/09/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/zSTL/vector/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="vector">vector</span>
            <span class="post-date" title="2022-09-15 19:33:36">2022/09/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/zSTL/string/"
           data-tag="STL"
           data-author="" >
            <span class="post-title" title="string">string</span>
            <span class="post-date" title="2022-09-15 16:29:29">2022/09/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/15/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/%E8%B0%93%E8%AF%8D/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="谓词">谓词</span>
            <span class="post-date" title="2022-09-15 16:19:03">2022/09/15</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/15/DesignMode/Creational%20Pattern/Singleton/"
           data-tag="创建型模式"
           data-author="" >
            <span class="post-title" title="单例模式">单例模式</span>
            <span class="post-date" title="2022-09-15 16:04:46">2022/09/15</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/15/DesignMode/Creational%20Pattern/Factory/"
           data-tag="创建型模式"
           data-author="" >
            <span class="post-title" title="factory模式">factory模式</span>
            <span class="post-date" title="2022-09-15 16:04:46">2022/09/15</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/13/%E9%A2%98%E8%A7%A3/%E6%8B%AC%E5%8F%B7%E7%94%9F%E6%88%90/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="括号生成">括号生成</span>
            <span class="post-date" title="2022-09-13 16:21:25">2022/09/13</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/11/%E9%A2%98%E8%A7%A3/csp/2022_06_2/"
           data-tag="csp"
           data-author="" >
            <span class="post-title" title="寻宝大作战">寻宝大作战</span>
            <span class="post-date" title="2022-09-11 16:31:29">2022/09/11</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/09/09/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/WPSlesson1/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="金山训练营第一周">金山训练营第一周</span>
            <span class="post-date" title="2022-09-09 19:46:09">2022/09/09</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/08/%E9%A2%98%E8%A7%A3/%E6%8A%8A%E6%95%B0%E7%BB%84%E6%8E%92%E6%88%90%E6%9C%80%E5%B0%8F%E7%9A%84%E6%95%B0/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="把数组排成最小的数">把数组排成最小的数</span>
            <span class="post-date" title="2022-09-08 14:13:19">2022/09/08</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/08/%E9%A2%98%E8%A7%A3/%E5%90%8C%E6%9E%84%E5%AD%97%E7%AC%A6%E4%B8%B2/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="同构字符串">同构字符串</span>
            <span class="post-date" title="2022-09-08 12:31:34">2022/09/08</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/07/%E9%A2%98%E8%A7%A3/%E6%95%B0%E7%BB%84%E6%B8%B8%E6%88%8F/"
           data-tag="字节"
           data-author="" >
            <span class="post-title" title="数组游戏">数组游戏</span>
            <span class="post-date" title="2022-09-07 16:57:46">2022/09/07</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/07/%E9%A2%98%E8%A7%A3/%E5%85%A8%E6%8E%92%E5%88%97/"
           data-tag="math"
           data-author="" >
            <span class="post-title" title="全排列">全排列</span>
            <span class="post-date" title="2022-09-07 13:01:27">2022/09/07</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/06/%E9%A2%98%E8%A7%A3/%E6%97%A5%E6%9C%9F%E5%B7%AE%E5%80%BC/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="日期差值">日期差值</span>
            <span class="post-date" title="2022-09-06 16:14:24">2022/09/06</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/09/04/%E9%A2%98%E8%A7%A3/%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2/"
           data-tag="动态规划"
           data-author="" >
            <span class="post-title" title="零钱兑换">零钱兑换</span>
            <span class="post-date" title="2022-09-04 12:13:58">2022/09/04</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/09/01/DesignMode/Behavioral%20Pattern/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"
           data-tag="行为型模式"
           data-author="" >
            <span class="post-title" title="策略模式">策略模式</span>
            <span class="post-date" title="2022-09-01 10:25:44">2022/09/01</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/08/30/cpp/cpp11/%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="智能指针">智能指针</span>
            <span class="post-date" title="2022-08-30 20:56:50">2022/08/30</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/08/30/cpp/cpp11/nullptr/"
           data-tag="c++11"
           data-author="" >
            <span class="post-title" title="nullptr">nullptr</span>
            <span class="post-date" title="2022-08-30 20:41:05">2022/08/30</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/08/30/%E9%A2%98%E8%A7%A3/%E5%89%8Dk%E4%B8%AA%E9%AB%98%E9%A2%91%E8%AF%8D/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="前k个高频词">前k个高频词</span>
            <span class="post-date" title="2022-08-30 20:09:01">2022/08/30</span>
        </a>
        
        
        <a  class="All 设计模式 "
           href="/2022/08/30/DesignMode/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="设计模式简介">设计模式简介</span>
            <span class="post-date" title="2022-08-30 19:44:16">2022/08/30</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/08/12/%E9%A2%98%E8%A7%A3/%E6%97%A0%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E4%B8%B2/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="无重复字符的最长子串">无重复字符的最长子串</span>
            <span class="post-date" title="2022-08-12 10:09:13">2022/08/12</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/08/10/%E9%A2%98%E8%A7%A3/%E5%8F%8D%E8%BD%AC%E9%93%BE%E8%A1%A8/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="反转链表">反转链表</span>
            <span class="post-date" title="2022-08-10 11:41:17">2022/08/10</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/08/10/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/sort/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="排序">排序</span>
            <span class="post-date" title="2022-08-10 10:04:24">2022/08/10</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/08/08/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/%E9%93%BE%E6%8E%A5%E7%BC%96%E8%AF%91%E8%BF%9E%E7%BC%96/"
           data-tag="cpp"
           data-author="" >
            <span class="post-title" title="链接编译联编">链接编译联编</span>
            <span class="post-date" title="2022-08-08 11:21:41">2022/08/08</span>
        </a>
        
        
        <a  class="All Git "
           href="/2022/08/05/git/git/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="git常用方法">git常用方法</span>
            <span class="post-date" title="2022-08-05 09:44:12">2022/08/05</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/07/30/cpp/%E5%8D%8E%E4%B8%BA%E5%8F%AF%E4%BF%A1/%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E8%A7%84%E5%AE%9A/"
           data-tag="华为可信课程"
           data-author="" >
            <span class="post-title" title="代码风格规定">代码风格规定</span>
            <span class="post-date" title="2022-07-30 10:52:08">2022/07/30</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/07/29/cpp/%E5%8D%8E%E4%B8%BA%E5%8F%AF%E4%BF%A1/lambda%E3%80%81%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E4%B8%8E%E6%9D%82%E9%A1%B9/"
           data-tag="华为可信课程"
           data-author="" >
            <span class="post-title" title="lambda、资源管理与杂项">lambda、资源管理与杂项</span>
            <span class="post-date" title="2022-07-29 19:01:40">2022/07/29</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/07/29/cpp/%E5%8D%8E%E4%B8%BA%E5%8F%AF%E4%BF%A1/%E5%87%BD%E6%95%B0%E4%B8%8E%E7%B1%BB/"
           data-tag="华为可信课程,编码规范"
           data-author="" >
            <span class="post-title" title="类与函数">类与函数</span>
            <span class="post-date" title="2022-07-29 18:01:02">2022/07/29</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/07/15/cpp/%E5%8D%8E%E4%B8%BA%E5%8F%AF%E4%BF%A1/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E5%8F%98%E9%87%8F/"
           data-tag="华为可信课程"
           data-author="" >
            <span class="post-title" title="表达式与变量">表达式与变量</span>
            <span class="post-date" title="2022-07-15 09:50:49">2022/07/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/07/15/cpp/%E5%8D%8E%E4%B8%BA%E5%8F%AF%E4%BF%A1/%E5%AE%89%E5%85%A8%E7%BC%96%E7%A0%81%E4%B8%8E%E6%9C%AA%E5%AE%9A%E4%B9%89%E8%A1%8C%E4%B8%BA/"
           data-tag="华为可信课程"
           data-author="" >
            <span class="post-title" title="安全编码与未定义行为">安全编码与未定义行为</span>
            <span class="post-date" title="2022-07-15 09:07:10">2022/07/15</span>
        </a>
        
        
        <a  class="All cpp "
           href="/2022/07/13/cpp/%E7%9F%A5%E8%AF%86%E7%82%B9/define,const/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="define、const、typedef、inline">define、const、typedef、inline</span>
            <span class="post-date" title="2022-07-13 10:19:04">2022/07/13</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/06/06/%E9%A2%98%E8%A7%A3/csp/2021_09_2/"
           data-tag="csp"
           data-author="" >
            <span class="post-title" title="非零段划分">非零段划分</span>
            <span class="post-date" title="2022-06-06 21:12:44">2022/06/06</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/03/26/%E9%A2%98%E8%A7%A3/%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A82/"
           data-tag="动态规划"
           data-author="" >
            <span class="post-title" title="买卖股票1">买卖股票1</span>
            <span class="post-date" title="2022-03-26 20:36:28">2022/03/26</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/03/26/%E9%A2%98%E8%A7%A3/%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A81/"
           data-tag="动态规划"
           data-author="" >
            <span class="post-title" title="买卖股票1">买卖股票1</span>
            <span class="post-date" title="2022-03-26 20:08:12">2022/03/26</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/03/23/%E9%A2%98%E8%A7%A3/%E5%AD%97%E5%85%B8%E5%BA%8F%E7%9A%84%E7%AC%ACk%E5%A4%A7%E6%95%B0%E5%AD%97/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="字典序的第k大数字">字典序的第k大数字</span>
            <span class="post-date" title="2022-03-23 20:26:38">2022/03/23</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/03/03/%E9%A2%98%E8%A7%A3/EasyStrings/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Easy Strings Merging">Easy Strings Merging</span>
            <span class="post-date" title="2022-03-03 19:29:40">2022/03/03</span>
        </a>
        
        
        <a  class="All 题解 "
           href="/2022/03/03/%E9%A2%98%E8%A7%A3/%E7%AC%ACk%E4%B8%AA%E6%95%B0%E5%AD%97/"
           data-tag="leetcode"
           data-author="" >
            <span class="post-title" title="779 第k个语法符号">779 第k个语法符号</span>
            <span class="post-date" title="2022-03-03 15:13:51">2022/03/03</span>
        </a>
        
        
        <a  class="All "
           href="/2022/03/01/hello-world/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hello World">Hello World</span>
            <span class="post-date" title="2022-03-01 19:26:09">2022/03/01</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-cpp/cpp11/多线程·" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">多线程</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="cpp">cpp</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color1">c++11</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2023-04-09 13:39:14'>2022-11-27 17:02</time>
        
    </div>
    <div class="article-meta">
        
        <span>Count:8.6k</span>
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                Comment:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="toc-text">多线程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#C-11-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9B%B8%E5%85%B3%E7%9A%84%E5%A4%B4%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-text">C++11 多线程相关的头文件：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8B"><span class="toc-text">启动线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#C-11-std-thread%E6%BA%90%E7%A0%81"><span class="toc-text">C++11 std::thread源码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="toc-text">如何传递参数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%80%BC%E4%BC%A0%E9%80%92"><span class="toc-text">值传递</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92"><span class="toc-text">引用传递</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E4%BC%A0%E9%80%92"><span class="toc-text">指针传递</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0"><span class="toc-text">使用成员函数作为参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0"><span class="toc-text">使用lambda表达式作为参数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E7%AD%89%E5%BE%85%E5%92%8C%E5%88%86%E7%A6%BB"><span class="toc-text">线程等待和分离</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#call-once"><span class="toc-text">call_once</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%8A%B6%E6%80%81"><span class="toc-text">多线程状态</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%9E%E4%BA%89%E7%8A%B6%E6%80%81%E5%92%8C%E4%B8%B4%E7%95%8C%E7%8A%B6%E6%80%81"><span class="toc-text">竞争状态和临界状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mutex"><span class="toc-text">mutex</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%92%E6%96%A5%E9%94%81%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E5%9C%B0%E6%96%B9"><span class="toc-text">互斥锁需要注意的地方</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B6%85%E6%97%B6%E9%94%81"><span class="toc-text">超时锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E9%94%81"><span class="toc-text">递归锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB%E9%94%81-shared-mutex"><span class="toc-text">共享锁 shared_mutex</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RAII%E9%A3%8E%E6%A0%BC%E9%94%81"><span class="toc-text">RAII风格锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lock-guard"><span class="toc-text">lock_guard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unique-lock"><span class="toc-text">unique_lock</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#unique-lock%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%8F%82%E6%95%B0"><span class="toc-text">unique_lock的第二个参数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#std-adopt-lock"><span class="toc-text">std::adopt_lock</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#std-try-to-lock"><span class="toc-text">std::try_to_lock</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#std-defer-lock"><span class="toc-text">std::defer_lock</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shared-lock"><span class="toc-text">shared_lock</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scoped-lock%E5%8C%BA%E5%9F%9F%E9%94%81"><span class="toc-text">scoped_lock区域锁</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#condition-variable"><span class="toc-text">condition_variable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%AD%A5%E9%AA%A4"><span class="toc-text">改变共享变量的线程步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%89%E5%BE%85%E4%BF%A1%E5%8F%B7%E8%AF%BB%E5%8F%96%E5%85%B1%E4%BA%AB%E5%8F%98%E9%87%8F%E7%9A%84%E7%BA%BF%E7%A8%8B%E6%AD%A5%E9%AA%A4"><span class="toc-text">等待信号读取共享变量的线程步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E7%A8%8B%E5%BC%82%E6%AD%A5%E5%92%8C%E9%80%9A%E4%BF%A1"><span class="toc-text">线程异步和通信</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#promise-%E5%92%8C-future"><span class="toc-text">promise 和 future</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#std-packaged-task"><span class="toc-text">std::packaged_task</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#async-%E5%88%9B%E5%BB%BA%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B"><span class="toc-text">async 创建异步线程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#c-20-%E7%BA%BF%E7%A8%8B%E7%89%B9%E6%80%A7"><span class="toc-text">c++20 线程特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#std-barrier-%E5%B1%8F%E9%9A%9C"><span class="toc-text">std::barrier 屏障</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-5 i,
    .toc-level-5 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h1><ul>
<li>并行是指两个或多个独立的操作同时进行。</li>
<li>并发是指一个时间段内执行多个操作。</li>
</ul>
<p><strong>线程：</strong> 线程是操作系统能够进行CPU调度的最小单位，它被包含在进程之中，一个进程可包含单个或者多个线程。可以用多个线程去完成一个任务，也可以用多个进程去完成一个任务，它们的本质都相当于多个人去合伙完成一件事。</p>
<p><strong>多线程并发：</strong> 多线程是实现并发(双核的真正并行或者单核机器的任务切换都叫并发）的一种手段，多线程并发即多个线程同时执行,一般而言，多线程并发就是把一个任务拆分为多个子任务，然后交由不同线程处理不同子任务,使得这多个子任务同时执行。</p>
<p><strong>C++多线程并发：</strong>  （简单情况下）实现C++多线程并发程序的思路如下：将任务的不同功能交由多个函数分别实现，创建多个线程，每个线程执行一个函数，一个任务就这样同时分由不同线程执行了。</p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppISCnO"><img src="https://s1.ax1x.com/2023/04/05/ppISCnO.png" alt="ppISCnO.png"></a></p>
<h2 id="C-11-多线程相关的头文件："><a href="#C-11-多线程相关的头文件：" class="headerlink" title="C++11 多线程相关的头文件："></a>C++11 多线程相关的头文件：</h2><ul>
<li><p>atomic：该头文主要声明了两个类, std::atomic 和 std::atomic_flag，另外还声明了一套 C 风格的原子类型和与 C 兼容的原子操作的函数。</p>
</li>
<li><p>thread：该头文件主要声明了 std::thread 类，另外 std::this_thread 命名空间也在该头文件中。</p>
</li>
<li><p>mutex：该头文件主要声明了与互斥量(mutex)相关的类，包括 std::mutex 系列类，std::lock，std::try_lock std::lock_guard, std::unique_lock, 以及其他的类型和函数。</p>
</li>
<li><p>condition_variable&gt;：该头文件主要声明了与条件变量相关的类，包括 std::condition_variable 和 std::condition_variable_any。</p>
</li>
<li><p>future：该头文件主要声明了 std::promise, std::package_task 两个 Provider 类，以及 std::future 和 std::shared_future 两个 Future 类，另外还有一些与之相关的类型和函数，std::async() 函数就声明在此头文件中。</p>
</li>
</ul>
<h2 id="启动线程"><a href="#启动线程" class="headerlink" title="启动线程"></a>启动线程</h2><p>首先要引入头文件#include<thread>，管理线程的函数和类在该头文件中声明，其中包括std::thread类。<br>语句”std::thread th1(proc1);”创建了一个名为th1的线程，并且线程th1开始执行。</thread></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;thread&gt;
using namespace std;
void proc1(int &amp;a)
&#123;
    cout &lt;&lt; &quot;我是子线程,传入参数为&quot; &lt;&lt; a &lt;&lt; endl;
    cout &lt;&lt; &quot;子线程中显示子线程id为&quot; &lt;&lt; this_thread::get_id()&lt;&lt; endl;
&#125;
int main()
&#123;
    cout &lt;&lt; &quot;我是主线程&quot; &lt;&lt; endl;
    int a = 9;
    thread th1(proc1,ref(a));//第一个参数为函数名，第二个参数为该函数的第一个参数，如果该函数接收多个参数就依次写在后面。此时线程开始执行。
    cout &lt;&lt; &quot;主线程中显示子线程id为&quot; &lt;&lt; th1.get_id() &lt;&lt; endl;
    //此处省略多行，不要在创建完线程后马上join,应该在程序结束前join
    th1.join()；//此时主线程被阻塞直至子线程执行结束。
    return 0;
&#125;
</code></pre>
<p>如果仅仅是调用无参数的构造函数，不会启动一个新的线程，直到指定了线程函数。</p>
<pre><code>std::vector&lt;std::thread&gt; threads(10); // 此时没有启动线程
​
for(int i=0;i&lt;10;++i)&#123;
    threads[i]=std::thread(do_some_work);
    // 此时才启动线程
&#125;
</code></pre>
<h3 id="C-11-std-thread源码"><a href="#C-11-std-thread源码" class="headerlink" title="C++11 std::thread源码"></a>C++11 std::thread源码</h3><pre><code>class thread
&#123;
    //.....
    thread() noexcept : _Thr&#123;&#125; &#123;&#125;
    explicit thread(_Fn&amp;&amp; _Fx, _Args&amp;&amp;... _Ax) &#123;
        //.....
        _Thr._Hnd =reinterpret_cast&lt;void*&gt;(_CSTD _beginthreadex(nullptr, 0, _Invoker_proc,_Decay_copied.get(), 0, &amp;_Thr._Id));
    &#125;

    ~thread() noexcept &#123;
        if (joinable()) &#123;
            _STD terminate();
        &#125;
    &#125;
&#125;;
</code></pre>
<h3 id="如何传递参数"><a href="#如何传递参数" class="headerlink" title="如何传递参数"></a>如何传递参数</h3><p>新拉起的线程肯定是开辟新的参数副本，这样就能避免临界区竞争、访问已经被析构的变量等问题。<br><code>std::thread</code>拉起一个新线程，会进行两次copy：</p>
<ul>
<li>第一次在调用std::thread构造函数时，会在新线程保存一份变量。可以是赋值构造、也可以是移动构造；</li>
<li>第二次在把保存的变量传递给线程函数时，这里统一是用std::move，即移动构造；</li>
</ul>
<h4 id="值传递"><a href="#值传递" class="headerlink" title="值传递"></a>值传递</h4><p>下面是一个示例</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
//Linux -lpthread
using namespace std;
class Para
&#123;
public:
    Para() &#123; cout &lt;&lt; &quot;Create Para&quot; &lt;&lt; endl; &#125;
    Para(const Para&amp; p) &#123; cout &lt;&lt; &quot;Copy Para&quot; &lt;&lt; endl; &#125;
    ~Para() &#123; cout &lt;&lt; &quot;Drop Para&quot; &lt;&lt; endl; &#125;
    string name;
&#125;;

void ThreadMain(int p1, float p2, string str, Para p4)
&#123;
    this_thread::sleep_for(100ms);
    cout &lt;&lt; &quot;ThreadMain &quot; &lt;&lt; p1 &lt;&lt; &quot; &quot; &lt;&lt; p2 &lt;&lt; &quot; &quot; &lt;&lt; str &lt;&lt;&quot; &quot;&lt;&lt;p4.name&lt;&lt; endl;
&#125;

int main(int argc, char* argv[])
&#123;
    thread th;
    &#123;
    float f1 = 12.1f;
    Para p;
    p.name = &quot;test Para class&quot;;
    //所有的参数做复制
    th =  thread(ThreadMain, 101, f1, &quot;test string para&quot;,p);
    &#125;
    th.join();
    return 0;
&#125;
</code></pre>
<p>输出结果</p>
<pre><code>Create Para
Copy Para
Drop Para
Copy Para
ThreadMain 101 12.1 test string para
Drop Para
Drop Para
</code></pre>
<p>示例2：</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
//Linux -lpthread
using namespace std;
class Para
&#123;
public:
    Para() &#123; cout &lt;&lt; &quot;Create Para&quot; &lt;&lt; endl; &#125;
    Para(const Para&amp; p) &#123; cout &lt;&lt; &quot;Copy Para&quot; &lt;&lt; endl; &#125;
    Para(Para&amp;&amp; p) &#123; cout &lt;&lt; &quot;move Para&quot; &lt;&lt; endl; &#125;
    ~Para() &#123; cout &lt;&lt; &quot;Drop Para&quot; &lt;&lt; endl; &#125;
    string name;
&#125;;

void ThreadMain(int p1, float p2, string str, Para p4)
&#123;
    this_thread::sleep_for(100ms);
    cout &lt;&lt; &quot;ThreadMain &quot; &lt;&lt; p1 &lt;&lt; &quot; &quot; &lt;&lt; p2 &lt;&lt; &quot; &quot; &lt;&lt; str &lt;&lt;&quot; &quot;&lt;&lt;p4.name&lt;&lt; endl;
&#125;

int main(int argc, char* argv[])
&#123;
    thread th;
    &#123;
    float f1 = 12.1f;
    Para p;
    p.name = &quot;test Para class&quot;;
    //所有的参数做复制
    th =  thread(ThreadMain, 101, f1, &quot;test string para&quot;,p);
    &#125;
    th.join();
    return 0;
&#125;
</code></pre>
<p>输出结果</p>
<pre><code>Create Para
Copy Para
Drop Para
move Para
ThreadMain 101 12.1 test string para
Drop Para
Drop Para
</code></pre>
<p>可以看到有移动拷贝则使用移动拷贝，否则使用赋值拷贝</p>
<h4 id="引用传递"><a href="#引用传递" class="headerlink" title="引用传递"></a>引用传递</h4><p>因为新的线程是开辟了新的参数副本，但这样做也有缺点，不能用引用传递参数了，也就不能修改原值。<br>这时我们需要用c++11提供的std::ref这个模板函数，它会返回一个类，本质上是维护了一个指针，所有操作都会改变指针指向的变量，相当于起到引用的功能。</p>
<p>举个例子：</p>
<pre><code>void update_data_for_widget(widget_id w,widget_data&amp; data); // 引用传参
void oops_again(widget_id w)
&#123;
    widget_data data;
    std::thread t(update_data_for_widget,w,data); // error 右值不可以匹配到左值引用
    display_status();
    t.join();
&#125;
</code></pre>
<p>因为在第二次传参时，发生了std::move强转为右值，不能匹配widget_data&amp;左值引用，自然报错。如果非要用引用传参，需要用std::ref。</p>
<p>把那一行代码改为std::thread t(update_data_for_widget,w,std::ref(data));就可以了。</p>
<p>我们会发现std::thread和std::bind的参数传递过程很像，先在本地copy一份副本，当真正执行时，再把参数传入到执行函数。本质上是因为thread和bind都不知道用户何时执行，为了避免发生悬挂指针等错误，保存一份副本是值得的行为。</p>
<h4 id="指针传递"><a href="#指针传递" class="headerlink" title="指针传递"></a>指针传递</h4><p>在向线程函数传递参数时，我们需要注意以下场景：</p>
<p>浅拷贝了一个指针<br>    void f(int i,std::string const&amp; s);<br>    void oops(int some_param)<br>    {<br>        char buffer[1024];<br>        sprintf(buffer, “%i”,some_param);<br>        std::thread t(f,3,buffer);<br>        t.detach();<br>    }<br>buffer是数组指针，在构造时采用浅拷贝，只拷贝了buffer指针，所以新的线程还是访问了主线程的buffer[1024]。让事情雪上加霜的是，采用非阻塞式detach，这意味着很有可能新线程在访问数组时，数组已经被析构了！</p>
<p>解决方法是采用深拷贝，在传入前转换为std::string：</p>
<pre><code>void f(int i,std::string const&amp; s);
void oops(int some_param)
&#123;
    char buffer[1024]; 
    sprintf(buffer, &quot;%i&quot;,some_param);
    std::thread t(f,3,std::string(buffer)); // 避免悬挂指针
    t.detach(); 
&#125;
</code></pre>
<h4 id="使用成员函数作为参数"><a href="#使用成员函数作为参数" class="headerlink" title="使用成员函数作为参数"></a>使用成员函数作为参数</h4><pre><code>class MyThread
&#123;
public:
    //入口线程函数
    void Main()
    &#123;
        cout &lt;&lt; &quot;MyThread Main &quot; &lt;&lt; name &lt;&lt; &quot;:&quot; &lt;&lt; age;
    &#125;
    string name;
    int age = 100;
&#125;;
int main()
&#123;
    MyThread myth;
    myth.name = &quot;Test name 001&quot;;
    myth.age = 20;
    //需要传入对象地址
    thread th(&amp;MyThread::Main, &amp;myth);
    th.join();
    return 0;
&#125;
</code></pre>
<h4 id="使用lambda表达式作为参数"><a href="#使用lambda表达式作为参数" class="headerlink" title="使用lambda表达式作为参数"></a>使用lambda表达式作为参数</h4><pre><code>class TestLambda
&#123;
public:
    void Start()
    &#123;
        thread th([this]() &#123;cout &lt;&lt; &quot;name = &quot; &lt;&lt; name &lt;&lt; endl; &#125;);
        th.join();
    &#125;
    string name = &quot;test lambda&quot;;
&#125;;

int main()
&#123;
    thread th(
        [](int i) &#123;cout &lt;&lt; &quot;test lmbda &quot; &lt;&lt; i &lt;&lt; endl; &#125;,
        123
    );
    th.join();
    TestLambda test;
    test.Start();
    return 0;
&#125;
</code></pre>
<h2 id="线程等待和分离"><a href="#线程等待和分离" class="headerlink" title="线程等待和分离"></a>线程等待和分离</h2><p>detach其实就是一个守护线程。</p>
<p>守护进程的概念：发起就遗忘，即使当前进程运行到结束，但守护进程依旧继续执行，直到整个程序被关闭了。总而言之，守护进程不需要.join()等待了，拉起来就让它一直伴随左右。<br>由于在Linux中，每一个系统与用户进行交流的界面称为终端，每一个从此终端开始运行的进程都会依附于这个终端，这个终端称为这些进程的控制终端，当控制终端被关闭时，相应的进程都会自动关闭。<br>但是守护进程却能够突破这种限制，它从被执行开始运转，直到接收到某种信号或者整个系统关闭时才会退出。如果想让某个进程不因为用户、终端或者其他的变化而受到影响，那么就必须把这个进程变成一个守护进程。</p>
<p>此外，std::thread还有一个joinable()方法用于检测线程是否有效。<br>joinable：代表该线程是可执行线程（即刚初始化完成，拥有线程所有权，且没结束运行）<br>not-joinable：通常一下几种情况会导致线程成为not-joinable：</p>
<ul>
<li>由thread的缺省构造函数构造而成(thread()没有参数)；</li>
<li>该thread被move过（包括move构造和move赋值）；</li>
<li>该线程调用过join或者detach（调用过后就置为non-joinable）；</li>
</ul>
<p>线程不安全行为<br>下面介绍detach和join这两种情况下的不安全行为：<br>detach。由于detach不阻塞，很有可能访问到已经析构的对象。如：</p>
<pre><code>struct func
&#123;
    int&amp; i;
    func(int&amp; i_) : i(i_) &#123;&#125;
    void operator() ()
    &#123;
        for (unsigned j=0 ; j&lt;1000000 ; ++j)
        &#123;
            do_something(i); // 潜在访问隐患： 悬空引用
        &#125;
    &#125;
&#125;;
​
void oops()
&#123;
    int some_local_state=0;
    func my_func(some_local_state);
    std::thread my_thread(my_func);
    my_thread.detach(); 
    // detach不等待线程结束，所以很有可能变量i已经析构了
&#125;
</code></pre>
<p>join。当发生异常时，容易忘记执行join。</p>
<pre><code>struct func; 
void f()
&#123;
    int some_local_state=0;
    func my_func(some_local_state);
    std::thread t(my_func);
    try&#123;
        do_something_in_current_thread();
    &#125;
    catch(...)&#123;
        t.join(); 
        throw;
    &#125;
    t.join(); 
&#125;
</code></pre>
<p>当发生异常这类特殊情况时，join很容易遗漏，发生不安全的行为。</p>
<pre><code>class thread_guard
&#123;
private:
    std::thread&amp; t;
public:
    explicit thread_guard(std::thread&amp; t_):t(t_)&#123;&#125;
    
    ~thread_guard()&#123;
        if(t.joinable())&#123; // 是否是可执行的线程
            t.join(); 
        &#125;
    &#125;
&#125;;
</code></pre>
<h2 id="call-once"><a href="#call-once" class="headerlink" title="call_once"></a>call_once</h2><p>std:call_once的作用，确保函数或代码片段在多线程环境下，只需要执行一次，常用的场景如Init()操作或一些系统参数的获取等。<br>相对来说，std::call_once用法比较简单，配合std::once_flag即可实现，代码如下：</p>
<pre><code>#include &quot;stdafx.h&quot;
#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;mutex&gt;

std::once_flag flag;

void Initialize()
&#123;
    std::cout &lt;&lt; &quot;Run into Initialize..&quot; &lt;&lt; std::endl;
&#125;

void Init()
&#123;
    std::call_once(flag, Initialize);
&#125;

int main()
&#123;
    std::thread t1(Init);
    std::thread t2(Init);
    std::thread t3(Init);
    std::thread t4(Init);
    t1.join();
    t2.join();
    t3.join();
    t4.join();
&#125;
</code></pre>
<p>最终Initialize()只调用了一次</p>
<h2 id="多线程状态"><a href="#多线程状态" class="headerlink" title="多线程状态"></a>多线程状态</h2><p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppIPYoF"><img src="https://s1.ax1x.com/2023/04/05/ppIPYoF.png" alt="ppIPYoF.png"></a></p>
<ul>
<li><p>初始化状态：在执行new Thread(s)，线程对象一旦创建就进入初始化状态</p>
</li>
<li><p>就绪状态：在线程对象创建完成后调用start方法，但是线程不会立刻调度执行，而是进入就绪状态，因为在运行前还有一些准备工作要做</p>
</li>
<li><p>运行状态：准备工作完成后进入运行状态，一个运行状态的线程可能正在运行也可能没有运行，这取决于操作系统给线程提供运行的时间（Java的规范说明没有将它作为一个单独状态，准确的说这个状态应该是可运行状态，因为任何时刻，这个状态的某个线程可能正在运行也可能没有运行）</p>
</li>
<li><p>阻塞状态： 当一个线程被插队、礼让别的线程或者休眠时就会进入到阻塞状态，阻塞状态解除后回到就绪状态，等待CPU调度执行</p>
</li>
<li><p>退出状态 当一个运行状态的线程自然执行完毕后或者中断后线程进入退出状态，退出后无法再次启动</p>
</li>
</ul>
<h3 id="竞争状态和临界状态"><a href="#竞争状态和临界状态" class="headerlink" title="竞争状态和临界状态"></a>竞争状态和临界状态</h3><ul>
<li><p>竞争条件</p>
<ul>
<li>竞争条件是指多个任务以非互斥的方式同时进入临界区， 大家对公共资源的访问是以竞争的方式并行进行的，因此公共资源的最终状态依赖于这些任务的临界区中的微操作执行次序。</li>
</ul>
</li>
<li><p>临界区</p>
<ul>
<li>程序要想使用某些资源，必然通过一些指令去访问这些资源，若多个任务都访问同一公共资源，那么各任务中访问公共资源的指令代码组成的区域就称为临界区。怕有同学看得不仔细，强调一下，临界区是指程序中那些访问公共资源的指令代码，即临界区是指令，并不是受访的静态公共资源。</li>
</ul>
</li>
<li><p>互斥</p>
<ul>
<li>互斥也可称为排他， 是指某一时刻公共资源只能被 1 个任务独享， 即不允许多个任务同时出现在自己的临界区中。公共资源在任意时刻只能被一个任务访问，即只能有一个任务在自己的临界区中执行，其他任务想访问公共资源时，必须等待当前公共资源的访问者完全执行完他自己的临界区代码后（使用完资源后）再开始访问。</li>
</ul>
</li>
</ul>
<h3 id="mutex"><a href="#mutex" class="headerlink" title="mutex"></a>mutex</h3><p>std::mutex 是C++11 中最基本的互斥量，std::mutex 对象提供了独占所有权的特性——即不支持递归地对 std::mutex 对象上锁，而 std::recursive_lock 则可以递归地对互斥量对象上锁。<br>mutex常用操作：</p>
<ul>
<li>lock()：资源上锁</li>
<li>unlock()：解锁资源</li>
<li>trylock()：查看是否上锁，它有下列3种类情况：<ul>
<li>未上锁返回false，并锁住；</li>
<li>其他线程已经上锁，返回true；</li>
<li>同一个线程已经对它上锁，将会产生死锁。</li>
</ul>
</li>
</ul>
<p>通过锁可以防止临界区的冲突</p>
<pre><code>#include &lt;iostream&gt;  // std::cout
#include &lt;thread&gt;  // std::thread
#include &lt;mutex&gt;  // std::mutex

std::mutex mtx;  // mutex for critical section
void print_block (int n, char c) 
&#123;
    mtx.lock();
    for (int i=0; i&lt;n; ++i) 
    &#123;
        std::cout &lt;&lt; c; 
    &#125;
    std::cout &lt;&lt; &#39;\n&#39;;
    mtx.unlock();
&#125;
int main ()
&#123;
    std::thread th1 (print_block,50,&#39;&#39;);//线程1：打印*
    std::thread th2 (print_block,50,&#39;$&#39;);//线程2：打印$
    th1.join();
    th2.join();
    return 0;
&#125;
</code></pre>
<h4 id="互斥锁需要注意的地方"><a href="#互斥锁需要注意的地方" class="headerlink" title="互斥锁需要注意的地方"></a>互斥锁需要注意的地方</h4><p>多线程锁有一个问题就是在解锁之后立刻请求锁，这样会导致可能一个线程一直占用着锁导致其他线程无法获得锁。</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;mutex&gt;
using namespace std;
static mutex mux;
void ThreadMainMux(int i)
&#123;
    for (;;)
    &#123;
        mux.lock();
        cout &lt;&lt; i &lt;&lt; &quot;[in]&quot; &lt;&lt; endl;
        this_thread::sleep_for(1000ms);
        mux.unlock();
    &#125;
&#125;
int main(int argc, char* argv[])
&#123;
    for (int i = 0; i &lt; 3; i++)
    &#123;
        thread th(ThreadMainMux, i + 1);
        th.detach();
    &#125;
    getchar();
    return 0;
&#125;
</code></pre>
<p>解决的一个办法是解锁后等待一个时间段以后再重新请求锁</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;mutex&gt;
//Linux -lpthread
using namespace std;
static mutex mux;
void ThreadMainMux(int i)
&#123;
    for (;;)
    &#123;
        mux.lock();
        cout &lt;&lt; i &lt;&lt; &quot;[in]&quot; &lt;&lt; endl;
        this_thread::sleep_for(1000ms);
        mux.unlock();
        //this_thread::sleep_for(1ms);
    &#125;
&#125;
int main(int argc, char* argv[])
&#123;
    for (int i = 0; i &lt; 3; i++)
    &#123;
        thread th(ThreadMainMux, i + 1);
        th.detach();
    &#125;
    getchar();
    return 0;
&#125;
</code></pre>
<h3 id="超时锁"><a href="#超时锁" class="headerlink" title="超时锁"></a>超时锁</h3><p>功能：避免长时间死锁，可以记录锁获取情况，多次超时，可以记录日志，获取错误情况<br>由于try_lock(）不会阻塞该线程，那么将会一直占着CPU资源，因此加入sleep_for(100ms)延时给其他线程一点机会，然而延时是调用的this_thread下的函数：</p>
<pre><code>if (!mux.try_lock())
&#123;
    cout &lt;&lt; &quot;.&quot; &lt;&lt; flush;
    this_thread::sleep_for(100ms);
    continue;
&#125;
</code></pre>
<p>c++还提供了另外一个解决方法，就是使用超时锁</p>
<pre><code>timed_mutex tmux;

void ThreadMainTime(int i)
&#123;
    for (;;)
    &#123;
        if (!tmux.try_lock_for(chrono::milliseconds(500)))
        &#123; 
            //如果未在规定时间内拿到锁，那么这段代码可能会出现问题，这里可以进行日志的写入，便于调试
            cout &lt;&lt; i &lt;&lt; &quot;[try_lock_for timeout]&quot; &lt;&lt; endl;
            continue;
        &#125;
        cout &lt;&lt; i &lt;&lt; &quot;[in]&quot; &lt;&lt; endl;
        this_thread::sleep_for(2000ms);
        tmux.unlock();
        this_thread::sleep_for(1ms);
    &#125;
&#125;
</code></pre>
<h3 id="递归锁"><a href="#递归锁" class="headerlink" title="递归锁"></a>递归锁</h3><p>递归锁允许同一个线程多次获取该互斥锁，可以用来解决同一线程需要多次获取互斥量时死锁的问题。</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;mutex&gt;
struct Complex
&#123;
    std::mutex mutex;
    int i;
    Complex() : i(0)&#123;&#125;
    void mul(int x)
    &#123;
        std::lock_guard&lt;std::mutex&gt; lock(mutex);
        i *= x;
    &#125;
    void div(int x)
    &#123;
        std::lock_guard&lt;std::mutex&gt; lock(mutex);
        i /= x;
    &#125;
    void both(int x, int y)
    &#123;
        std::lock_guard&lt;std::mutex&gt; lock(mutex);
        mul(x);
        div(y);
    &#125;
&#125;;
int main(void)
&#123;
    Complex complex;
    complex.both(32, 23);
    return 0;
&#125;
</code></pre>
<p>运行后出现死锁的情况。在调用both时获取了互斥量，在调用mul时又要获取互斥量，但both的并没有 释放，从而产生死锁。</p>
<p>使用递归锁解决同一个线程的死锁问题：</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;mutex&gt;
struct Complex
&#123;
    std::recursive_mutex mutex;
    int i;
    Complex() : i(0)&#123;&#125;
    void mul(int x)
    &#123;
        std::lock_guard&lt;std::recursive_mutex&gt; lock(mutex);
        i *= x;
    &#125;
    void div(int x)
    &#123;
        std::lock_guard&lt;std::recursive_mutex&gt; lock(mutex);
        i /= x;
    &#125;
    void both(int x, int y)
    &#123;
        std::lock_guard&lt;std::recursive_mutex&gt; lock(mutex);
        mul(x);
        div(y);
    &#125;
&#125;;
int main(void)
&#123;
    Complex complex;
    complex.both(32, 23); //因为同一线程可以多次获取同一互斥量，不会发生死锁
    std::cout &lt;&lt; &quot;main finish\n&quot;;
    return 0;
&#125;
</code></pre>
<h3 id="共享锁-shared-mutex"><a href="#共享锁-shared-mutex" class="headerlink" title="共享锁 shared_mutex"></a>共享锁 shared_mutex</h3><p>C++17起，shared_mutex 类是一个同步原语，可用于保护共享数据不被多个线程同时访问。与便于独占访问的其他互斥类型不同，shared_mutex 拥有二个访问级别：</p>
<ul>
<li>共享 - 多个线程能共享同一互斥的所有权；</li>
<li>独占性 - 仅一个线程能占有互斥。<br>1）若一个线程已经通过lock或try_lock获取独占锁（写锁），则无其他线程能获取该锁（包括共享的）。尝试获得读锁的线程也会被阻塞。<br>2）仅当任何线程均未获取独占性锁时，共享锁（读锁）才能被多个线程获取（通过 lock_shared 、try_lock_shared ）。<br>3）在一个线程内，同一时刻只能获取一个锁（共享或独占性）。</li>
</ul>
<p>按照如下代码，读取只能有一个线程进入，在很多业务场景中，没有充分利用 cpu 资源</p>
<pre><code>//读取 同时只能有一个线程读取
mux.lock();
cout&lt;&lt;share&lt;&lt;endl;
mux.unlock();

//写入
mux.lock() 
share++; 
mux.unlock()
</code></pre>
<p>可以看到这个无论读还是写都无法并行处理，显然读操作即上面打印操作是可以并行的</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;mutex&gt;
#include &lt;shared_mutex&gt;
using namespace std;

//c++17  共享锁
//shared_mutex smux;

//c++14 
shared_timed_mutex stmux;

void ThreadRead(int i)
&#123;
    for (;;)
    &#123;
        stmux.lock_shared();
        cout &lt;&lt; i &lt;&lt; &quot; Read&quot; &lt;&lt; endl;
        this_thread::sleep_for(1000ms);
        stmux.unlock_shared();
        this_thread::sleep_for(1ms);
    &#125;
&#125;
void ThreadWrite(int i)
&#123;
    for (;;)
    &#123;
        stmux.lock_shared();
        //读取数据
        stmux.unlock_shared();
        stmux.lock(); //互斥锁 写入
        cout &lt;&lt; i &lt;&lt; &quot; Write&quot; &lt;&lt; endl;
        this_thread::sleep_for(1000ms);
        stmux.unlock();
        this_thread::sleep_for(1ms);
    &#125;
&#125;
int main(int argc, char* argv[])
&#123;
    for (int i = 0; i &lt; 3; i++)
    &#123;
        thread th(ThreadWrite, i + 1);
        th.detach();
    &#125;
    for (int i = 0; i &lt; 3; i++)
    &#123;
        thread th(ThreadRead, i + 1);
        th.detach();
    &#125;
    getchar();
    return 0;
&#125;
</code></pre>
<h2 id="RAII风格锁"><a href="#RAII风格锁" class="headerlink" title="RAII风格锁"></a>RAII风格锁</h2><p><strong>什么是RAII：</strong><br>资源获取即初始化（Resource Acquisition Is Initialization），或称 RAII，是一种 C++ 编程技术，它将必须在使用前请求的资源（分配的堆内存、执行线程、打开的套接字、打开的文件、锁定的互斥体、磁盘空间、数据库连接等——任何存在受限供给中的事物）的生命周期绑定与一个对象的生存期相绑定。<br><strong>RAII 可总结如下:</strong><br>将每个资源封装入一个类，其中构造函数请求资源，并建立所有类不变式，或在它无法完成时抛出异常，析构函数释放资源并决不抛出异常；始终经由 RAII 类的实例使用满足要求的资源，该资源自身拥有自动存储期或临时生存期，或具有与自动或临时对象的生存期绑定的生存期。移动语义使得在对象间，跨作用域，以及在线程内外安全地移动所有权，而同时维护资源安全成为可能。</p>
<p>手动实现一个最简单的RAII锁：</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;mutex&gt;
#include &lt;shared_mutex&gt;
using namespace std;

class XMutex
&#123;
public:
    XMutex(mutex&amp; mux):mux_(mux)
    &#123;
        mux.lock();
    &#125;
    ~XMutex()
    &#123;
        mux_.unlock();
    &#125;
private:
    mutex&amp; mux_;
&#125;;
static mutex mux;
void TestMutex(int status)
&#123;
    XMutex test(mux);
    if (status == 1)
    &#123;
        cout &lt;&lt; &quot;=1&quot; &lt;&lt; endl;
        return;
    &#125;
    else
    &#123;
        cout &lt;&lt; &quot;!=1&quot; &lt;&lt; endl;
        return;
    &#125;
&#125;
int main(int argc, char* argv[])
&#123;
    TestMutex(1);
    TestMutex(2);
    getchar();
    return 0;
&#125;
</code></pre>
<p>上面是一个最简单的体现RAII思维的锁，还需要实现模板，移动语义以及如果构造参数传入的锁锁住以后防止死锁等。</p>
<h3 id="lock-guard"><a href="#lock-guard" class="headerlink" title="lock_guard"></a>lock_guard</h3><p>这是构造互斥锁的写法，会在lock_guard构造函数里加锁，在析构函数里解锁，这个写法，C++委员会的解释是防止使用mutex加锁解锁的时候，忘记解锁unlock了。</p>
<pre><code>template &lt;class _Mutex&gt;
class lock_guard &#123; 
public:
    using mutex_type = _Mutex;
    explicit lock_guard(_Mutex&amp; _Mtx) : _MyMutex(_Mtx) &#123; 
        _MyMutex.lock();
    &#125;

    lock_guard(_Mutex&amp; _Mtx, adopt_lock_t) : _MyMutex(_Mtx) &#123;&#125;

    ~lock_guard() noexcept &#123;
        MyMutex.unlock();
    &#125;
    lock_guard(const lock_guard&amp;) = delete; 
    lock_guard&amp; operator=(const lock_guard&amp;) = delete;
&#125;；
</code></pre>
<p>可以看到锁的所有权是不会改变的，拷贝构造移动构造都被禁止使用了<br>下面这个例子利用了lock_guard自动对锁进行释放<br>    #include <iostream><br>    #include <thread><br>    #include <string><br>    #include <mutex><br>    using namespace std;</mutex></string></thread></iostream></p>
<pre><code>mutex mt;
void thread_task()
&#123;
    for (int i = 0; i &lt; 1000; i++)
    &#123;
        lock_guard&lt;mutex&gt; guard(mt);
        cout &lt;&lt; &quot;print thread: &quot; &lt;&lt; i &lt;&lt; endl;
    &#125;
&#125;

int main()
&#123;
    thread t(thread_task);
    for (int i = 0; i &gt; -1000; i--)
    &#123;
        lock_guard&lt;mutex&gt; guard(mt);
        cout &lt;&lt; &quot;print main: &quot; &lt;&lt; i &lt;&lt; endl;
    &#125;
    t.join();
    return 0;
&#125;
</code></pre>
<h3 id="unique-lock"><a href="#unique-lock" class="headerlink" title="unique_lock"></a>unique_lock</h3><p>虽然lock_guard挺好用，但他有个很大的缺陷，在定义lock_guard的地方会调用构造函数加锁，在离开定义域的话lock_guard就会被销毁，调用析构函数解锁。这就产生了一个问题，如果这个定义域范围很大的话，那么锁的粒度就很大，很大程序上会影响效率。为了解决lock_guard锁的粒度过大的原因，unique_lock就出现了。<br>unique_lock C++11 实现可移动的互斥体所有权包装器</p>
<ul>
<li>支持临时释放锁 unlock</li>
<li>支持 adopt_lock（已经拥有锁，不加锁，出栈区会释放） </li>
<li>支持 defer_lock （延后拥有，不加锁，出栈区不释放）</li>
<li>支持 try_to_lock 尝试获得互斥的所有权而不阻塞 ，获取失败退出栈区不会释放，通过owns_lock()函数判断</li>
<li>支持超时参数，超时不拥有锁</li>
</ul>
<h4 id="unique-lock的第二个参数"><a href="#unique-lock的第二个参数" class="headerlink" title="unique_lock的第二个参数"></a>unique_lock的第二个参数</h4><p>unique_lock 可以带第二个参数：<br>std::unique_lock<a href="std::mutex">std::mutex</a> sbguard1(my_mutex1, std::adopt_lock);&#x2F;&#x2F; std::adopt_lock标记作用；</p>
<h5 id="std-adopt-lock"><a href="#std-adopt-lock" class="headerlink" title="std::adopt_lock"></a>std::adopt_lock</h5><p>表示这个互斥量已经被lock了（你必须要把互斥量提前lock了 ，否者会报异常）；std::adopt_lock标记的效果就是假设调用一方已经拥有了互斥量的所有权（已经lock成功了）；通知lock_guard不需要再构造函数中lock这个互斥量了。<br>unique_lock也可以带std::adopt_lock标记，含义相同，就是不希望再unique_lock()的构造函数中lock这个mutex。<br>用std::adopt_lock的前提是，自己需要先把mutex lock上；用法与lock_guard相同。</p>
<h5 id="std-try-to-lock"><a href="#std-try-to-lock" class="headerlink" title="std::try_to_lock"></a>std::try_to_lock</h5><p>try_to_lock的意思是尝试加锁，它的好处就是——当线程A拿不到锁的时候，线程A不会等在那里，它会去做一些别的事情，用这个try_to_lock的前提是你自己不能先lock。</p>
<h5 id="std-defer-lock"><a href="#std-defer-lock" class="headerlink" title="std::defer_lock"></a>std::defer_lock</h5><p>用std::defer_lock的前提是，你不能自己先lock,否则会报异常，std::defer_lock的意思就是并没有给mutex加锁：初始化了一个没有加锁的mutex。我们借着defer_lock的话题，来介绍一些unique_lock的重要成员函数。</p>
<h3 id="shared-lock"><a href="#shared-lock" class="headerlink" title="shared_lock"></a>shared_lock</h3><p>shared_lock  c++14开始引入<br>类 shared_lock 是通用共享互斥所有权包装器（unique_lock则是独占互斥所有权包装器），允许延迟锁定、定时锁定和锁所有权的转移。锁定 shared_lock，会以共享模式锁定关联的共享互斥</p>
<pre><code>//共享锁
static shared_timed_mutex  tmux;
//读取锁 共享锁
&#123;
    //调用共享锁 
    shared_lock&lt;shared_timed_mutex&gt; lock(tmux);
    cout &lt;&lt; &quot;read data&quot; &lt;&lt; endl;
    //退出栈区 释放共享锁
&#125;
//写入锁 互斥锁
&#123;
    unique_lock&lt;shared_timed_mutex&gt; lock(tmux);
    cout &lt;&lt; &quot;write data&quot; &lt;&lt; endl;
&#125;
</code></pre>
<p>shared_lock是read lock。被锁后仍允许其他线程执行同样被shared_lock的代码。这是一般做读操作时的需要。<br>unique_lock是write lock。被锁后不允许其他线程执行被shared_lock或unique_lock的代码。在写操作时，一般用这个，可以同时限制unique_lock的写和share_lock的读。</p>
<h3 id="scoped-lock区域锁"><a href="#scoped-lock区域锁" class="headerlink" title="scoped_lock区域锁"></a>scoped_lock区域锁</h3><p>scoped_lock C++17<br>将多个锁（std::mutex等）包装成一种锁类型，用于线程一次性申请多个锁，避免死锁。<br>scoped_lock使用std::lock函数，其会调用一个特殊的算法对所提供的互斥量调用try_lock函数，这是为了避免死锁。因此，在加锁与解锁的顺序相同的情况下，使用scoped_lock或对同一组锁调用std::lock都是非常安全的。可以同时对一堆锁同时加锁，要么同时成功，要么加锁同时失败，不会出现死锁情况。</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;mutex&gt;
#include &lt;shared_mutex&gt;
void TestScope1()
&#123;
    //模拟死锁 停100ms等另一个线程锁mux2
    this_thread::sleep_for(100ms); 
    cout &lt;&lt;this_thread::get_id()&lt;&lt; &quot; begin mux1 lock&quot; &lt;&lt; endl;
    //mux1.lock();
    cout &lt;&lt; this_thread::get_id() &lt;&lt; &quot; begin mux2 lock&quot; &lt;&lt; endl;
    //mux2.lock(); //死锁
    //c++11
    // lock(mux1, mux2);
    //c++17 
    scoped_lock lock(mux1, mux2); // 解决死锁
    
    cout &lt;&lt; &quot;TestScope1&quot; &lt;&lt; endl;
    this_thread::sleep_for(1000ms);
    
    //mux1.unlock();
    //mux2.unlock();
&#125;
void TestScope2()
&#123;
    cout &lt;&lt; this_thread::get_id() &lt;&lt; &quot; begin mux2 lock&quot; &lt;&lt; endl;
    mux2.lock();
    this_thread::sleep_for(500ms);
    cout &lt;&lt; this_thread::get_id() &lt;&lt; &quot; begin mux1 lock&quot; &lt;&lt; endl;
    mux1.lock();//死锁
    cout &lt;&lt; &quot;TestScope2&quot; &lt;&lt; endl;
    this_thread::sleep_for(1500ms);
    mux1.unlock();
    mux2.unlock();
&#125;
int main(int argc, char* argv[])
&#123;
    //演示死锁情况
    &#123;
        thread th(TestScope1);
        th.detach();
    &#125;
    &#123;
        thread th(TestScope2);
        th.detach();
    &#125;
    getchar();
    return 0;
&#125;
</code></pre>
<h2 id="condition-variable"><a href="#condition-variable" class="headerlink" title="condition_variable"></a>condition_variable</h2><p>条件变量是利用线程间共享的全局变量进行同步的一种机制，主要包括两个动作：一个线程等待<br>条件变量的条件成立而挂起;另一个线程使条件成立（给出条件成立信号）。为了防止竞争，条件变量的使用总是和一个互斥量结合在一起。</p>
<h3 id="改变共享变量的线程步骤"><a href="#改变共享变量的线程步骤" class="headerlink" title="改变共享变量的线程步骤"></a>改变共享变量的线程步骤</h3><p><strong>准备好信号量</strong></p>
<pre><code>std::condition_variable cv;
</code></pre>
<p><strong>1获得 std::mutex （常通过 std::unique_lock ）</strong></p>
<pre><code>unique_lock lock(mux);
</code></pre>
<p><strong>2在获取锁时进行修改</strong></p>
<pre><code>msgs_.push_back(data);
</code></pre>
<p><strong>3释放锁并通知读取线程</strong></p>
<pre><code>lock.unlock();
cv.notify_one(); //通知一个等待信号线程
cv.notify_all(); //通知所有等待信号线程
</code></pre>
<h3 id="等待信号读取共享变量的线程步骤"><a href="#等待信号读取共享变量的线程步骤" class="headerlink" title="等待信号读取共享变量的线程步骤"></a>等待信号读取共享变量的线程步骤</h3><p><strong>1获得与改变共享变量线程共同的mutex</strong></p>
<pre><code>unique_lock lock(mux);
</code></pre>
<p><strong>2 wait() 等待信号通知</strong><br>2.1无lambada 表达式</p>
<pre><code>//解锁lock,并阻塞等待 notify_one notify_all 通知
cv.wait(lock);

//接收到通知会再次获取锁标注，也就是说如果此时mux资源被占用，wait函数会阻塞
msgs_.front();
//处理数据
msgs_.pop_front();
</code></pre>
<p>2.2lambada 表达式cv.wait(lock, [] {return !msgs_.empty();});<br>只在 std::unique_lock<a href="std::mutex">std::mutex</a> 上工作的 std::condition_variable</p>
<pre><code>void wait(unique_lock&lt;mutex&gt;&amp; _Lck) &#123; 
    // wait for signal
    // Nothing to do to comply with LWG‐2135 because std::mutex lock/unlock are nothrow
    _Check_C_return(_Cnd_wait(_Mycnd(), _Lck.mutex()‐&gt;_Mymtx()));
&#125;
template &lt;class _Predicate&gt;
void wait(unique_lock&lt;mutex&gt;&amp; _Lck, _Predicate _Pred) &#123; 
    // wait for signal and test predicate
    while (!_Pred())
    &#123; 
        wait(_Lck);
    &#125;
&#125;
</code></pre>
<p>代码示例：</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;mutex&gt;
#include &lt;list&gt;
#include &lt;string&gt;
#include &lt;sstream&gt;
using namespace std;
list&lt;string&gt; msgs_;
mutex mux;
condition_variable cv;
void ThreadWrite()
&#123;
    for (int i = 0;;i++)
    &#123;
        stringstream ss;
        cout &lt;&lt; &quot;write msg &quot; &lt;&lt; i &lt;&lt; endl;
        ss &lt;&lt; &quot;msg &quot; &lt;&lt; i;
        unique_lock&lt;mutex&gt; lock(mux);
        msgs_.push_back(ss.str());
        lock.unlock();
        cv.notify_one(); //发送信号
        this_thread::sleep_for(3000ms);
    &#125;
&#125;
void ThreadRead(int i)
&#123;
    while(1)
    &#123;
        unique_lock&lt;mutex&gt; lock(mux);
        //cv.wait(lock);//解锁、阻塞等待信号
        cv.wait(lock, [i] 
        &#123;
            return !msgs_.empty(); 
        &#125;);
        //获取信号后锁定
        while (!msgs_.empty())
        &#123;
            cout &lt;&lt; &quot;ThreadRead &quot; &lt;&lt; i &lt;&lt; &quot; read &quot; &lt;&lt; msgs_.front() &lt;&lt; endl;
            msgs_.pop_front();
        &#125;

    &#125;
&#125;
int main(int argc, char* argv[])
&#123;
    thread th(ThreadWrite);
    th.detach();
    for (int i = 0; i &lt; 3; i++)
    &#123;
        thread th(ThreadRead, i + 1);
        th.detach();
    &#125;
    getchar();
    return 0;
&#125;
</code></pre>
<h2 id="线程异步和通信"><a href="#线程异步和通信" class="headerlink" title="线程异步和通信"></a>线程异步和通信</h2><h3 id="promise-和-future"><a href="#promise-和-future" class="headerlink" title="promise 和 future"></a>promise 和 future</h3><p>future和promise的作用是在不同线程之间传递数据。使用指针也可以完成数据的传递，但是指针非常危险，因为互斥量不能阻止指针的访问；而且指针的方式传递的数据是固定的，如果更改数据类型，那么还需要更改有关的接口，比较麻烦；promise支持泛型的操作，更加方便编程处理。</p>
<ul>
<li>promise 用于异步传输变量<ul>
<li>std::promise 提供存储异步通信的值，再通过其对象创建的std::future异步获得结果。</li>
<li>std::promise 只能使用一次。 void set_value(_Ty&amp;&amp; _Val) 设置传递值，只能掉用一次</li>
</ul>
</li>
<li>std::future 提供访问异步操作结果的机制<ul>
<li>get() 阻塞等待promise set_value 的值</li>
</ul>
</li>
</ul>
<p>下面是一个例子，可以看到如果没有set  get会一直堵塞住</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;functional&gt;
#include &lt;future&gt;
#include &lt;thread&gt;
#include &lt;chrono&gt;
#include &lt;cstdlib&gt;

void thread_set_promise(std::promise&lt;int&gt;&amp; p) &#123;
    std::this_thread::sleep_for(std::chrono::milliseconds(3000));
    p.set_value(35);
&#125;

int main() &#123;
    std::promise&lt;int&gt; p;
    std::future&lt;int&gt; f = p.get_future();
    std::thread t(&amp;thread_set_promise, std::ref(p));
    std::cout &lt;&lt; f.get() &lt;&lt; std::endl;
    t.join();
    getchar();
    return 0;
&#125;
</code></pre>
<p>三秒后屏幕输出35 ，get一直堵塞，直到set函数调用以后截止</p>
<h3 id="std-packaged-task"><a href="#std-packaged-task" class="headerlink" title="std::packaged_task"></a>std::packaged_task</h3><p>std::packaged_task的作用就是提供一个不同线程之间的数据同步机制，它可以存储一个函数操作，并将其返回值传递给对应的future，而这个future在另外一个线程中也可以安全的访问到这个值。与bind的区别，可异步调用，函数访问和获取返回值分开调用</p>
<pre><code>#include &lt;iostream&gt;     // std::cout
#include &lt;future&gt;       // std::packaged_task, std::future
#include &lt;chrono&gt;       // std::chrono::seconds
#include &lt;thread&gt;       // std::thread, std::this_thread::sleep_for

using namespace std;
int countdown(int from, int to) &#123;
    for (int i = from; i != to; --i) &#123;
        std::cout &lt;&lt; i &lt;&lt; &#39;\n&#39;;
        std::this_thread::sleep_for(1s);
    &#125;
    std::cout &lt;&lt; &quot;Lift off!\n&quot;;
    return from - to;
&#125;

int main()
&#123;
    std::packaged_task&lt;int(int, int)&gt; tsk(countdown);   // set up packaged_task
    std::future&lt;int&gt; ret = tsk.get_future();            // get future
    std::thread th(std::move(tsk), 10, 0);   // spawn thread to count down from 10 to 0
    int value = ret.get();                  // wait for the task to finish and get result
    std::cout &lt;&lt; &quot;The countdown lasted for &quot; &lt;&lt; value &lt;&lt; &quot; seconds.\n&quot;;
    th.join();
    return 0;
&#125;
</code></pre>
<h3 id="async-创建异步线程"><a href="#async-创建异步线程" class="headerlink" title="async 创建异步线程"></a>async 创建异步线程</h3><p>std::async，通过这个异步接口可以很方便的获取线程函数的执行结果。std::async会自动创建一个线程去调用 线程函数，它返回一个std::future，这个future中存储了线程函数返回的结果，当我们需要线程函数的结果时，直接从future中获取。它解耦了线程的创建和执行，使得我们可以在需要的时候获取异步 操作的结果；其次它还提供了线程的创建策略（比如可以通过延迟加载的方式去创建线程），使得我们可以以多种方式去创建线程。</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;future&gt;
#include &lt;string&gt;
using namespace std;

string TestAsync(int index)
&#123;
    this_thread::sleep_for(2s);
    return &quot;test&quot;;
&#125;
int main(int argc, char* argv[])
&#123;
    //不创建线程启动异步任务
    auto future = async(launch::deferred, TestAsync,100);
    this_thread::sleep_for(100ms);
    cout &lt;&lt; &quot;future.get() = &quot; &lt;&lt; future.get() &lt;&lt; endl&lt;&lt;endl;

    //创建异步线程
    auto future2 = async(TestAsync, 101);
    this_thread::sleep_for(100ms);
    cout &lt;&lt; &quot;future2.get() = &quot; &lt;&lt; future2.get() &lt;&lt; endl;

    getchar();
    return 0;
&#125;
</code></pre>
<p>std::async 可以延迟调用，在get的时候调用函数。但是下面是启动了一个线程，该线程会直接启动执行。std::async是更高层次上的异步操作，使我们不用关注线程创建内部细节，就能方便的获取异步执行状态和结果，还可以指定线程创建策略，应该用std::async替代线程的创建，让它成为我们做异步操作的首选</p>
<pre><code>//#include &lt;execution&gt; c++17 
std::for_each(std::execution::par, //并行计算 多核
in_data.begin(), in_data.end(),[&amp;]()&#123;&#125;); //多线程进入此函数
</code></pre>
<h2 id="c-20-线程特性"><a href="#c-20-线程特性" class="headerlink" title="c++20 线程特性"></a>c++20 线程特性</h2><h3 id="std-barrier-屏障"><a href="#std-barrier-屏障" class="headerlink" title="std::barrier 屏障"></a>std::barrier 屏障</h3><ul>
<li>arrive<ul>
<li>到达屏障并减少期待计数</li>
</ul>
</li>
<li>wait<ul>
<li>在阶段同步点阻塞，直至运行其阶段完成步骤</li>
</ul>
</li>
<li>arrive_and_wait <ul>
<li>到达屏障并把期待计数减少一，然后阻塞直至当前阶段完成</li>
</ul>
</li>
<li>arrive_and_drop<ul>
<li>将后继阶段的初始期待计数和当前阶段的期待计数均减少一</li>
</ul>
</li>
</ul>
<p>下面是一个示例，目前使用的vs2019不支持，并没有下载最新版vs进行测试。</p>
<pre><code>#include &lt;thread&gt;
#include &lt;iostream&gt;
#include &lt;barrier&gt;
using namespace std;
void TestBar(int i, barrier&lt;&gt;* bar)
&#123;
    this_thread::sleep_for(chrono::seconds(i));
    cout &lt;&lt; i &lt;&lt; &quot; begin wait&quot; &lt;&lt; endl;
    bar-&gt;wait(bar-&gt;arrive()); //期待数 -1 阻塞等待，期待为0是返回
    cout &lt;&lt; i &lt;&lt; &quot; end wait&quot; &lt;&lt; endl;

&#125;
int main(int argc, char* argv[])
&#123;
    int count = 3;
    barrier bar(count);//初始数量
    for (int i = 0; i &lt; count; i++)
    &#123;
        thread th(TestBar, i, &amp;bar);
        th.detach();
    &#125;
    getchar();
    return 0;
&#125;
</code></pre>
<p>输出：</p>
<pre><code>begin wait
begin wait
begin wait
end wait
end wait
end wait
</code></pre>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 3366576307@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">💰</a>
</p>




    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: '9863a58d805d69a19ec3',
            clientSecret: 'eec6c8ede04bbc286f4410646f54282eafb3b33f',
            repo: 'talkFile.github.io',
            owner: 'whl963854',
            admin: ['whl963854'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="//cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<input type="hidden" id="MathJax-js"
        value="//cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</input>
    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2022 whl
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #c1bfc1;
    }
    
    
    .nav-right nav a.hover > span{
        color: #ffffff !important;
    }
    

    /*列表样式*/
    
    #post .pjax article .article-entry>ol, #post .pjax article .article-entry>ul, #post .pjax article>ol, #post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    #post .pjax article .article-entry li>ol, #post .pjax article .article-entry li>ul,#post .pjax article li>ol, #post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    #post .pjax article .article-entry>ol>li, #post .pjax article .article-entry>ul>li,#post .pjax article>ol>li, #post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    #post .pjax article .article-entry li>ol>li, #post .pjax article .article-entry li>ul>li,#post .pjax article li>ol>li, #post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>






<div class="mobile-menus-out" >

</div>
<div class="mobile-menus">
    
    
    
    
    <a class="dynamic-menu " target="_blank"  href="https://github.com/whl963854">github</a>
    
</div>

<div id="musicMouseDrag" style="position:fixed; z-index: 9999; bottom: 0; right: 0;">
<div id="musicDragArea" style="position: absolute; top: 0; left: 0; width: 100%;height: 10px;cursor: move; z-index: 10;"></div>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=483671599&auto=1&height=66"></iframe>
</div>




<!--以下代码是为了支持随时拖动音乐控件的位置，如没有需求，可去掉下面代码-->
<script>
var $DOC = $(document)
$('#musicMouseDrag').on('mousedown', function (e) {
// 阻止文本选中
$DOC.bind("selectstart", function () {
return false;
});
$('#musicDragArea').css('height', '100%');
var $moveTarget = $('#musicMouseDrag');
$moveTarget.css('border', '1px dashed grey')
var div_x = e.pageX - $moveTarget.offset().left;
var div_y = e.pageY - $moveTarget.offset().top;
$DOC.on('mousemove', function (e) {
var targetX = e.pageX - div_x;
var targetY = e.pageY - div_y;
targetX = targetX < 0 ? 0 : (targetX + $moveTarget.outerWidth() >= window.innerWidth) ? window.innerWidth - $moveTarget.outerWidth() : targetX;
targetY = targetY < 0 ? 0 : (targetY + $moveTarget.outerHeight() >= window.innerHeight) ? window.innerHeight - $moveTarget.outerHeight() : targetY;
$moveTarget.css({'left': targetX + 'px', 'top': targetY + 'px', 'bottom': 'inherit', 'right': 'inherit'})
}).on('mouseup', function () {
$DOC.unbind("selectstart");
$DOC.off('mousemove')
$DOC.off('mouseup')
$moveTarget.css('border', 'none')
$('#musicDragArea').css('height', '10px');
})
})
</script>
</html>
